<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>OUTSOURCING RSUD TALAUD 2026</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <style>
        :root {
            --primary-red: #DC143C;
            --dark-red: #8B0000;
            --light-red: #FFB6C1;
            --medical-blue: #0056b3;
            --light-blue: #e6f2ff;
            --dark-gray: #2c3e50;
            --medium-gray: #7f8c8d;
            --light-gray: #ecf0f1;
            --white: #ffffff;
            --success-green: #28a745;
            --warning-yellow: #ffc107;
            --danger-red: #dc3545;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8f9fa;
            color: #333;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            margin: 0;
            padding: 0;
            padding-bottom: 70px;
            overflow-x: hidden;
        }

        /* Header Styles */
        .main-header {
            background: linear-gradient(135deg, var(--primary-red) 0%, var(--dark-red) 100%);
            color: white;
            padding: 12px 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
            height: 60px;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 100%;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .hospital-info {
            display: none;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .user-avatar {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background-color: var(--light-gray);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary-red);
            font-weight: bold;
            font-size: 14px;
        }

        .user-name {
            display: none;
        }

        /* Main Content */
        .main-content {
            margin-left: 0;
            padding: 15px;
            flex: 1;
            transition: all 0.3s ease;
            margin-top: 0;
            padding-bottom: 20px;
        }

        /* Page Title */
        .page-title {
            background: linear-gradient(135deg, var(--primary-red) 0%, var(--dark-red) 100%);
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .page-logo {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            flex-shrink: 0;
        }

        .page-title-content {
            flex: 1;
            min-width: 0;
        }

        .page-title h1 {
            font-size: 22px;
            font-weight: 700;
            margin: 0;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.2);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .page-title p {
            margin: 5px 0 0 0;
            font-size: 13px;
            opacity: 0.9;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .page-title .logo-right {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            flex-shrink: 0;
        }

        /* Beranda Page Styles */
        .welcome-section {
            background-color: var(--white);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            border-left: 4px solid var(--primary-red);
            text-align: center;
        }

        .welcome-section h3 {
            color: var(--primary-red);
            font-weight: 600;
            margin-bottom: 15px;
            font-size: 18px;
        }

        .welcome-section p {
            color: var(--dark-gray);
            font-size: 16px;
            line-height: 1.5;
            margin-bottom: 15px;
        }

        .info-section {
            background-color: var(--white);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            border-left: 4px solid var(--primary-red);
        }

        .info-section h4 {
            color: var(--primary-red);
            font-weight: 600;
            margin-bottom: 15px;
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .info-section p {
            color: var(--dark-gray);
            font-size: 16px;
            line-height: 1.5;
            margin-bottom: 10px;
        }

        .info-section ul {
            color: var(--dark-gray);
            font-size: 16px;
            line-height: 1.6;
            padding-left: 20px;
            margin-bottom: 0;
        }

        .info-section li {
            margin-bottom: 8px;
        }

        .info-section .highlight {
            color: var(--primary-red);
            font-weight: 600;
        }

        .warning-section {
            background-color: #fff3cd;
            border-left: 4px solid var(--warning-yellow);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .warning-section h4 {
            color: #856404;
            font-weight: 600;
            margin-bottom: 10px;
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .warning-section p {
            color: #856404;
            font-size: 16px;
            line-height: 1.5;
            margin-bottom: 0;
        }

        /* Report Type Selection */
        .report-type-selection {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }

        .report-type-card {
            flex: 1;
            background-color: var(--white);
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .report-type-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .report-type-card.active {
            border-color: var(--primary-red);
            background-color: rgba(220, 20, 60, 0.05);
        }

        .report-type-card i {
            font-size: 36px;
            color: var(--primary-red);
            margin-bottom: 10px;
        }

        .report-type-card h4 {
            color: var(--dark-gray);
            font-size: 18px;
            margin-bottom: 5px;
        }

        .report-type-card p {
            color: var(--medium-gray);
            font-size: 14px;
        }

        /* Form Styles */
        .form-container {
            background-color: var(--white);
            border-radius: 8px;
            padding: 25px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .form-title {
            color: var(--primary-red);
            font-weight: 700;
            margin-bottom: 25px;
            text-align: center;
            font-size: 20px;
        }

        .form-section {
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--light-gray);
        }

        .form-section:last-child {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }

        .section-title {
            color: var(--primary-red);
            font-weight: 600;
            margin-bottom: 15px;
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--dark-gray);
            font-size: 14px;
        }

        .form-control, .form-select {
            border: 1px solid #ced4da;
            border-radius: 6px;
            padding: 10px 15px;
            font-size: 14px;
            transition: all 0.3s ease;
            background-color: var(--white);
        }

        .form-control:focus, .form-select:focus {
            border-color: var(--primary-red);
            box-shadow: 0 0 0 0.2rem rgba(220, 20, 60, 0.25);
        }

        .btn-primary {
            background-color: var(--primary-red);
            border-color: var(--primary-red);
            padding: 12px 25px;
            font-weight: 600;
            border-radius: 6px;
            transition: all 0.3s ease;
            font-size: 14px;
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary:hover {
            background-color: var(--dark-red);
            border-color: var(--dark-red);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(220, 20, 60, 0.3);
        }

        /* Riwayat Page Styles */
        .history-container {
            margin-top: 20px;
        }

        .history-item {
            background-color: var(--white);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            border-left: 4px solid var(--primary-red);
        }

        .history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .history-title {
            font-weight: 600;
            color: var(--primary-red);
            font-size: 16px;
        }

        .history-date {
            font-size: 12px;
            color: var(--medium-gray);
        }

        .history-content {
            margin-bottom: 10px;
        }

        .history-field {
            margin-bottom: 5px;
            font-size: 14px;
        }

        .history-label {
            font-weight: 600;
            color: var(--dark-gray);
        }

        .history-value {
            color: var(--medium-gray);
        }

        .history-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid var(--light-gray);
        }

        .history-status {
            font-size: 12px;
            padding: 3px 8px;
            border-radius: 12px;
            background-color: var(--light-red);
            color: var(--dark-red);
        }

        .history-actions {
            display: flex;
            gap: 10px;
        }

        .history-action-btn {
            background: none;
            border: none;
            color: var(--primary-red);
            cursor: pointer;
            font-size: 16px;
        }

        .empty-state {
            text-align: center;
            padding: 50px 20px;
            background-color: var(--white);
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .empty-state i {
            font-size: 48px;
            color: var(--medium-gray);
            margin-bottom: 15px;
        }

        .empty-state h5 {
            color: var(--medium-gray);
            font-size: 18px;
            margin-bottom: 8px;
        }

        .empty-state p {
            color: var(--medium-gray);
            font-size: 14px;
        }

        /* Bottom Navigation - Menu Ikon Permanen di Bawah */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: var(--white);
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
            z-index: 1000;
            display: flex;
            justify-content: space-around;
            padding: 10px 0;
            border-top: 1px solid var(--light-gray);
            height: 70px;
        }

        .bottom-nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 5px 15px;
            text-decoration: none;
            color: var(--medium-gray);
            transition: all 0.3s ease;
            font-size: 11px;
        }

        .bottom-nav-item.active {
            color: var(--primary-red);
        }

        .bottom-nav-item i {
            font-size: 22px;
            margin-bottom: 3px;
        }

        .bottom-nav-item:hover {
            color: var(--primary-red);
        }

        /* Notification */
        .notification {
            position: fixed;
            top: 20px;
            right: 15px;
            background-color: var(--success-green);
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            display: none;
            z-index: 2000;
            animation: slideIn 0.3s ease;
            max-width: 300px;
            font-size: 14px;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* Confirmation Modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 1050;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background-color: var(--white);
            margin: 5% auto;
            padding: 25px;
            border-radius: 8px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from {
                transform: translateY(-50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--light-gray);
        }

        .modal-title {
            color: var(--primary-red);
            font-weight: 700;
            font-size: 20px;
        }

        .modal-body {
            max-height: 400px;
            overflow-y: auto;
        }

        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid var(--light-gray);
        }

        .btn-secondary {
            background-color: var(--medium-gray);
            border-color: var(--medium-gray);
            padding: 10px 20px;
            font-size: 14px;
        }

        .btn-secondary:hover {
            background-color: var(--dark-gray);
            border-color: var(--dark-gray);
        }

        .btn-primary-modal {
            background-color: var(--primary-red);
            border-color: var(--primary-red);
            padding: 10px 20px;
            font-size: 14px;
        }

        .btn-primary-modal:hover {
            background-color: var(--dark-red);
            border-color: var(--dark-red);
        }

        /* PIN Modal Styles */
        .pin-container {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
        }

        .pin-input {
            width: 50px;
            height: 50px;
            text-align: center;
            font-size: 24px;
            font-weight: bold;
            border: 2px solid var(--light-gray);
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .pin-input:focus {
            border-color: var(--primary-red);
            outline: none;
            box-shadow: 0 0 0 0.2rem rgba(220, 20, 60, 0.25);
        }

        .pin-error {
            color: var(--danger-red);
            font-size: 14px;
            text-align: center;
            margin-top: 10px;
            display: none;
        }

        /* Report Preview Styles */
        .report-preview {
            background-color: var(--light-gray);
            padding: 20px;
            border-radius: 6px;
            margin-bottom: 15px;
        }

        .report-preview-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--medium-gray);
        }

        .report-preview-title {
            color: var(--primary-red);
            font-weight: 700;
            font-size: 18px;
        }

        .report-preview-date {
            font-size: 14px;
            color: var(--medium-gray);
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .report-preview-item {
            margin-bottom: 15px;
        }

        .report-preview-label {
            font-weight: 600;
            color: var(--dark-gray);
            font-size: 14px;
            margin-bottom: 5px;
        }

        .report-preview-value {
            color: var(--medium-gray);
            font-size: 14px;
            word-wrap: break-word;
            line-height: 1.5;
            max-width: 100%;
        }

        .report-preview-meta {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }

        .report-preview-tag {
            background-color: var(--light-red);
            color: var(--dark-red);
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: 500;
        }

        .preview-image-container {
            margin-top: 20px;
            text-align: center;
        }

        .preview-image {
            max-width: 100%;
            max-height: 200px;
            border-radius: 6px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        /* Loading Spinner */
        .spinner-border {
            width: 1rem;
            height: 1rem;
            border-width: 0.15em;
            margin-right: 5px;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .page-title h1 {
                font-size: 18px;
            }
            
            .page-title p {
                font-size: 12px;
            }
            
            .page-logo {
                width: 40px;
                height: 40px;
            }
            
            .report-type-selection {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- Main Content -->
    <main class="main-content">
        <!-- Beranda Page -->
        <div id="beranda" class="page active">
            <!-- Page Title -->
            <div class="page-title">
                <img src="https://z-cdn-media.chatglm.cn/files/e8eeeb63-91db-4aba-846e-a668ffcce588.png?auth_key=1869369634-33607f0815054dd480ad50924e93be9e-0-fa826bc662af2f6175504c8eeb725f06" alt="Logo Kabupaten Talaud" class="page-logo">
                <div class="page-title-content">
                    <h1>Outsourcing RSUD Talaud 2026</h1>
                    <p>Sistem Pelaporan Karyawan</p>
                </div>
                <img src="https://z-cdn-media.chatglm.cn/files/d5a31111-e79f-406f-9c31-a71f6bf5e72d.png?auth_key=1869369634-ebd2d760cbe84bd1b54a3d72851d8f42-0-c320d702f01d0d94e6042dd3dc574f92" alt="Logo Keamanan dan Kesehatan Kerja" class="page-logo logo-right">
            </div>
            
            <!-- Welcome Section -->
            <div class="welcome-section">
                <h3><i class="bi bi-house-heart"></i> Selamat Datang</h3>
                <p>Silakan gunakan menu di bawah untuk membuat laporan kegiatan harian Anda. Laporan akan disimpan secara permanen di perangkat ini dan dikirim untuk diproses lebih lanjut. Harap jangan menghapus aplikasi agar riwayat laporan Anda tidak hilang.</p>
            </div>

            <!-- Working Hours Information -->
            <div class="info-section">
                <h4><i class="bi bi-clock-history"></i> Jam Kerja</h4>
                <p>Berikut adalah informasi jam kerja untuk berbagai jenis karyawan:</p>
                <ul>
                    <li><span class="highlight">Cleaning Service (Ruangan Rawat Inap & Rawat Jalan) serta Penata Halaman:</span> Senin sampai Sabtu</li>
                    <li><span class="highlight">Limbah RS:</span> Senin sampai Minggu</li>
                    <li><span class="highlight">Karyawan IPSRS:</span> 24 jam menyesuaikan jadwal ruangan</li>
                    <li><span class="highlight">Administrasi:</span> Senin sampai Jumat</li>
                </ul>
            </div>

            <!-- Warning Section - Perhatian Penting -->
            <div class="warning-section">
                <h4><i class="bi bi-exclamation-triangle"></i> Perhatian Penting</h4>
                <p><strong>Aturan Kehadiran:</strong> Anda wajib melaporkan kegiatan harian setiap hari bekerja.</p>
                <p><strong>Sanksi:</strong> Jika Anda tidak bekerja selama 2 hari berturut-turut tanpa memberikan keterangan yang jelas, kontrak kerja Anda akan dihentikan oleh perusahaan.</p>
                <p><strong>Penting:</strong> Pastikan selapapun kondisinya, selalu lakukan pelaporan kegiatan harian Anda agar kontrak kerja tetap berjalan.</p>
            </div>
        </div>

        <!-- Buat Laporan Page -->
        <div id="laporan" class="page" style="display: none;">
            <div class="page-title">
                <img src="https://z-cdn-media.chatglm.cn/files/e8eeeb63-91db-4aba-846e-a668ffcce588.png?auth_key=1869369634-33607f0815054dd480ad50924e93be9e-0-fa826bc662af2f6175504c8eeb725f06" alt="Logo Kabupaten Talaud" class="page-logo">
                <div class="page-title-content">
                    <h1>Pilih Jenis Laporan</h1>
                    <p>Pilih jenis laporan yang ingin Anda buat</p>
                </div>
                <img src="https://z-cdn-media.chatglm.cn/files/d5a31111-e79f-406f-9c31-a71f6bf5e72d.png?auth_key=1869369634-ebd2d760cbe84bd1b54a3d72851d8f42-0-c320d702f01d0d94e6042dd3dc574f92" alt="Logo Keamanan dan Kesehatan Kerja" class="page-logo logo-right">
            </div>
            
            <!-- Report Type Selection -->
            <div class="report-type-selection">
                <div class="report-type-card" onclick="showEmployeeReport()">
                    <i class="bi bi-person-badge"></i>
                    <h4>Laporan Karyawan</h4>
                    <p>Buat laporan kegiatan harian sebagai karyawan outsourcing</p>
                </div>
                <div class="report-type-card" onclick="showSupervisorPinModal()">
                    <i class="bi bi-clipboard-check"></i>
                    <h4>Laporan Pengawas</h4>
                    <p>Buat laporan pengawasan dan evaluasi kinerja</p>
                </div>
            </div>
        </div>

        <!-- Form Laporan Karyawan -->
        <div id="laporanKaryawan" class="page" style="display: none;">
            <div class="page-title">
                <img src="https://z-cdn-media.chatglm.cn/files/e8eeeb63-91db-4aba-846e-a668ffcce588.png?auth_key=1869369634-33607f0815054dd480ad50924e93be9e-0-fa826bc662af2f6175504c8eeb725f06" alt="Logo Kabupaten Talaud" class="page-logo">
                <div class="page-title-content">
                    <h1>Form Laporan Karyawan</h1>
                    <p>Buat laporan kegiatan harian Anda</p>
                </div>
                <img src="https://z-cdn-media.chatglm.cn/files/d5a31111-e79f-406f-9c31-a71f6bf5e72d.png?auth_key=1869369634-ebd2d760cbe84bd1b54a3d72851d8f42-0-c320d702f01d0d94e6042dd3dc574f92" alt="Logo Keamanan dan Kesehatan Kerja" class="page-logo logo-right">
            </div>
            
            <div class="form-container">
                <form id="formLaporanKaryawan">
                    <div class="form-section">
                        <h3 class="section-title">
                            <i class="bi bi-person-fill"></i> Identitas Karyawan
                        </h3>
                        <div class="form-group">
                            <label class="form-label">Nama Karyawan</label>
                            <input type="text" class="form-control" id="namaKaryawan" required placeholder="Masukkan nama karyawan">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Jenis Karyawan</label>
                            <select class="form-select" id="jenisKaryawan" required>
                                <option value="">Pilih Jenis Karyawan</option>
                                <option value="Administrasi">Administrasi</option>
                                <option value="Cleaning Service">Cleaning Service</option>
                                <option value="Operator IPAL">Operator IPAL</option>
                                <option value="Penata Halaman">Penata Halaman</option>
                                <option value="Juru Masak">Juru Masak</option>
                                <option value="Limbah RS">Limbah RS</option>
                                <option value="Laundry">Laundry</option>
                                <option value="Teknisi IPSRS">Teknisi IPSRS</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Area Kerja/Ruangan</label>
                            <select class="form-select" id="areaKerja" required>
                                <option value="">Pilih Area Kerja</option>
                                <option value="Apotek/Gudang Apotek">Apotek/Gudang Apotek</option>
                                <option value="Bedah">Bedah</option>
                                <option value="Bedah Sentral">Bedah Sentral</option>
                                <option value="Binatu">Binatu</option>
                                <option value="Bougenville">Bougenville</option>
                                <option value="Crysant">Crysant</option>
                                <option value="Dahlia">Dahlia</option>
                                <option value="Edelweis VIP">Edelweis VIP</option>
                                <option value="Fisioterapi">Fisioterapi</option>
                                <option value="ICU">ICU</option>
                                <option value="IGD">IGD</option>
                                <option value="Isolasi">Isolasi</option>
                                <option value="IPAL">IPAL</option>
                                <option value="IPSRS">IPSRS</option>
                                <option value="Kantor/Manajemen">Kantor/Manajemen</option>
                                <option value="Kasir">Kasir</option>
                                <option value="NICU">NICU</option>
                                <option value="Pendaftaran">Pendaftaran</option>
                                <option value="Poliklinik">Poliklinik</option>
                                <option value="Radiologi">Radiologi</option>
                                <option value="Ruang Bersalin">Ruang Bersalin</option>
                                <option value="Seluruh Ruangan/Koridor RS">Seluruh Ruangan/Koridor RS</option>
                                <option value="Seluruh Halaman RS">Seluruh Halaman RS</option>
                                <option value="UTD">UTD</option>
                                <option value="Pemulasaran Jenazah">Pemulasaran Jenazah</option>
                                <option value="Laboratorium">Laboratorium</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Shift Kerja</label>
                            <select class="form-select" id="shiftKerja" required>
                                <option value="">Pilih Shift</option>
                                <option value="Malam">Malam</option>
                                <option value="Pagi">Pagi</option>
                                <option value="Siang">Siang</option>
                                <option value="24 Jam">24 Jam</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-section">
                        <h3 class="section-title">
                            <i class="bi bi-image-fill"></i> Dokumentasi
                        </h3>
                        <div class="form-group">
                            <label class="form-label">Upload Foto (Opsional)</label>
                            <input type="file" class="form-control" id="fotoLaporan" accept="image/*">
                        </div>
                    </div>
                    
                    <div class="text-center">
                        <button type="submit" class="btn btn-primary">
                            <i class="bi bi-send"></i> Kirim Laporan
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Form Laporan Pengawas -->
        <div id="laporanPengawas" class="page" style="display: none;">
            <div class="page-title">
                <img src="https://z-cdn-media.chatglm.cn/files/e8eeeb63-91db-4aba-846e-a668ffcce588.png?auth_key=1869369634-33607f0815054dd480ad50924e93be9e-0-fa826bc662af2f6175504c8eeb725f06" alt="Logo Kabupaten Talaud" class="page-logo">
                <div class="page-title-content">
                    <h1>Form Laporan Pengawas</h1>
                    <p>Buat laporan pengawasan dan evaluasi kinerja</p>
                </div>
                <img src="https://z-cdn-media.chatglm.cn/files/d5a31111-e79f-406f-9c31-a71f6bf5e72d.png?auth_key=1869369634-ebd2d760cbe84bd1b54a3d72851d8f42-0-c320d702f01d0d94e6042dd3dc574f92" alt="Logo Keamanan dan Kesehatan Kerja" class="page-logo logo-right">
            </div>
            
            <div class="form-container">
                <form id="formLaporanPengawas">
                    <div class="form-section">
                        <h3 class="section-title">
                            <i class="bi bi-person-badge-fill"></i> Identitas Pengawas
                        </h3>
                        <div class="form-group">
                            <label class="form-label">Nama Pengawas</label>
                            <input type="text" class="form-control" id="namaPengawas" required placeholder="Masukkan nama pengawas">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Tanggal Pengawasan</label>
                            <input type="date" class="form-control" id="tanggalPengawasan" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Area Pengawasan</label>
                            <select class="form-select" id="areaPengawasan" required>
                                <option value="">Pilih Area Pengawasan</option>
                                <option value="Apotek/Gudang Apotek">Apotek/Gudang Apotek</option>
                                <option value="Bedah">Bedah</option>
                                <option value="Bedah Sentral">Bedah Sentral</option>
                                <option value="Binatu">Binatu</option>
                                <option value="Bougenville">Bougenville</option>
                                <option value="Crysant">Crysant</option>
                                <option value="Dahlia">Dahlia</option>
                                <option value="Edelweis VIP">Edelweis VIP</option>
                                <option value="Fisioterapi">Fisioterapi</option>
                                <option value="ICU">ICU</option>
                                <option value="IGD">IGD</option>
                                <option value="Isolasi">Isolasi</option>
                                <option value="IPAL">IPAL</option>
                                <option value="IPSRS">IPSRS</option>
                                <option value="Kantor/Manajemen">Kantor/Manajemen</option>
                                <option value="Kasir">Kasir</option>
                                <option value="NICU">NICU</option>
                                <option value="Pendaftaran">Pendaftaran</option>
                                <option value="Poliklinik">Poliklinik</option>
                                <option value="Radiologi">Radiologi</option>
                                <option value="Ruang Bersalin">Ruang Bersalin</option>
                                <option value="Seluruh Ruangan/Koridor RS">Seluruh Ruangan/Koridor RS</option>
                                <option value="Seluruh Halaman RS">Seluruh Halaman RS</option>
                                <option value="UTD">UTD</option>
                                <option value="Pemulasaran Jenazah">Pemulasaran Jenazah</option>
                                <option value="Laboratorium">Laboratorium</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Shift Pengawasan</label>
                            <select class="form-select" id="shiftPengawasan" required>
                                <option value="">Pilih Shift</option>
                                <option value="Malam">Malam</option>
                                <option value="Pagi">Pagi</option>
                                <option value="Siang">Siang</option>
                                <option value="24 Jam">24 Jam</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-section">
                        <h3 class="section-title">
                            <i class="bi bi-people-fill"></i> Informasi Karyawan
                        </h3>
                        <div class="form-group">
                            <label class="form-label">Nama Karyawan yang Diawasi</label>
                            <input type="text" class="form-control" id="karyawanDiawasi" required placeholder="Masukkan nama karyawan yang diawasi">
                        </div>
                    </div>
                    
                    <div class="form-section">
                        <h3 class="section-title">
                            <i class="bi bi-clipboard2-check-fill"></i> Hasil Pengawasan
                        </h3>
                        <div class="form-group">
                            <label class="form-label">Hasil Pengawasan</label>
                            <textarea class="form-control" id="hasilPengawasan" rows="4" required placeholder="Deskripsikan hasil pengawasan yang dilakukan"></textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Catatan Evaluasi</label>
                            <textarea class="form-control" id="catatanEvaluasi" rows="3" placeholder="Tambahkan catatan evaluasi jika diperlukan"></textarea>
                        </div>
                    </div>
                    
                    <div class="form-section">
                        <h3 class="section-title">
                            <i class="bi bi-image-fill"></i> Dokumentasi
                        </h3>
                        <div class="form-group">
                            <label class="form-label">Upload Foto (Opsional)</label>
                            <input type="file" class="form-control" id="fotoPengawasan" accept="image/*">
                        </div>
                    </div>
                    
                    <div class="text-center">
                        <button type="submit" class="btn btn-primary">
                            <i class="bi bi-send"></i> Kirim Laporan
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Riwayat Laporan Page -->
        <div id="riwayat" class="page" style="display: none;">
            <div class="page-title">
                <img src="https://z-cdn-media.chatglm.cn/files/e8eeeb63-91db-4aba-846e-a668ffcce588.png?auth_key=1869369634-33607f0815054dd480ad50924e93be9e-0-fa826bc662af2f6175504c8eeb725f06" alt="Logo Kabupaten Talaud" class="page-logo">
                <div class="page-title-content">
                    <h1>Riwayat Laporan</h1>
                    <p>Lihat semua laporan yang telah dibuat</p>
                </div>
                <img src="https://z-cdn-media.chatglm.cn/files/d5a31111-e79f-406f-9c31-a71f6bf5e72d.png?auth_key=1869369634-ebd2d760cbe84bd1b54a3d72851d8f42-0-c320d702f01d0d94e6042dd3dc574f92" alt="Logo Keamanan dan Kesehatan Kerja" class="page-logo logo-right">
            </div>
            
            <!-- History Container -->
            <div class="history-container" id="historyContainer">
                <!-- History items will be inserted here -->
            </div>
            
            <!-- Empty State - No Reports Displayed -->
            <div class="empty-state" id="emptyState" style="display: none;">
                <i class="bi bi-inbox"></i>
                <h5>Belum Ada Riwayat Laporan</h5>
                <p>Anda belum membuat laporan. Silakan buat laporan baru menggunakan menu Laporan.</p>
            </div>
        </div>
    </main>

    <!-- Bottom Navigation - Menu Ikon Permanen di Bawah -->
    <nav class="bottom-nav">
        <a href="#" class="bottom-nav-item active" onclick="showPage('beranda')">
            <i class="bi bi-house-door"></i>
            <span>Beranda</span>
        </a>
        <a href="#" class="bottom-nav-item" onclick="showPage('laporan')">
            <i class="bi bi-file-earmark-plus"></i>
            <span>Laporan</span>
        </a>
        <a href="#" class="bottom-nav-item" onclick="showPage('riwayat')">
            <i class="bi bi-clock-history"></i>
            <span>Riwayat</span>
        </a>
    </nav>

    <!-- Notification -->
    <div id="notification" class="notification">
        <i class="bi bi-check-circle"></i> <span id="notificationText"></span>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirmationModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Konfirmasi Penyimpanan Laporan</h3>
                <span class="close" onclick="closeModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div class="report-preview" id="reportPreview">
                    <!-- Preview content will be inserted here -->
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeModal()">Batal</button>
                <button type="button" class="btn btn-primary-modal" id="confirmBtn" onclick="confirmSave()">
                    <i class="bi bi-save"></i> Simpan Laporan
                </button>
            </div>
        </div>
    </div>

    <!-- PIN Confirmation Modal -->
    <div id="pinModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Konfirmasi PIN Pengawas</h3>
                <span class="close" onclick="closePinModal()">&times;</span>
            </div>
            <div class="modal-body">
                <p>Masukkan PIN 4 digit untuk mengakses form laporan pengawas:</p>
                <div class="pin-container">
                    <input type="text" maxlength="1" class="pin-input" id="pin1" onkeyup="moveToNext(this, 'pin2')">
                    <input type="text" maxlength="1" class="pin-input" id="pin2" onkeyup="moveToNext(this, 'pin3')">
                    <input type="text" maxlength="1" class="pin-input" id="pin3" onkeyup="moveToNext(this, 'pin4')">
                    <input type="text" maxlength="1" class="pin-input" id="pin4" onkeyup="checkPin()">
                </div>
                <div class="pin-error" id="pinError">PIN yang Anda masukkan salah. Silakan coba lagi.</div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closePinModal()">Batal</button>
                <button type="button" class="btn btn-primary-modal" onclick="verifyPin()">Verifikasi</button>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // ==========================================
        // TELEGRAM CONFIGURATION
        // ==========================================
        // Konfigurasi untuk laporan karyawan
        const TELEGRAM_CHAT_ID_EMPLOYEE = "-1003637925420";
        const TELEGRAM_BOT_TOKEN_EMPLOYEE = "8355189455:AAGqJXf_OCoPWx11CSyeUk4fLhif156HjX4";
        const TELEGRAM_API_URL_EMPLOYEE = `https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN_EMPLOYEE}`;
        
        // Konfigurasi untuk laporan pengawas (sesuai permintaan)
        const TELEGRAM_CHAT_ID_SUPERVISOR = "-1003822735476";
        const TELEGRAM_BOT_TOKEN_SUPERVISOR = "8300283586:AAFhk9F9ZouK_gB9m0nbm5kFyzgFblgho1s";
        const TELEGRAM_API_URL_SUPERVISOR = `https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN_SUPERVISOR}`;
        
        // ==========================================
        // OFFLINE MODE CONFIGURATION
        // ==========================================
        const SUPERVISOR_PIN = "1234";
        let currentReportType = "";
        let currentReportData = null; // Store current report data globally

        // Show page function
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => {
                page.style.display = 'none';
            });
            
            document.getElementById(pageId).style.display = 'block';
            
            document.querySelectorAll('.bottom-nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            document.querySelector(`.bottom-nav-item[onclick="showPage('${pageId}')"]`).classList.add('active');
            
            // Load history if riwayat page is shown
            if (pageId === 'riwayat') {
                loadHistory();
            }
        }

        // Show employee report form
        function showEmployeeReport() {
            currentReportType = "karyawan";
            showPage('laporanKaryawan');
        }

        // Show supervisor PIN modal
        function showSupervisorPinModal() {
            document.getElementById('pinModal').style.display = 'block';
            // Reset PIN inputs
            document.getElementById('pin1').value = '';
            document.getElementById('pin2').value = '';
            document.getElementById('pin3').value = '';
            document.getElementById('pin4').value = '';
            document.getElementById('pinError').style.display = 'none';
            document.getElementById('pin1').focus();
        }

        // Close PIN modal
        function closePinModal() {
            document.getElementById('pinModal').style.display = 'none';
        }

        // Move to next PIN input
        function moveToNext(current, nextFieldID) {
            if (current.value.length >= 1) {
                document.getElementById(nextFieldID).focus();
            }
        }

        // Check PIN when last digit is entered
        function checkPin() {
            if (document.getElementById('pin4').value.length >= 1) {
                verifyPin();
            }
        }

        // Verify PIN
        function verifyPin() {
            const pin1 = document.getElementById('pin1').value;
            const pin2 = document.getElementById('pin2').value;
            const pin3 = document.getElementById('pin3').value;
            const pin4 = document.getElementById('pin4').value;
            const enteredPin = pin1 + pin2 + pin3 + pin4;
            
            if (enteredPin === SUPERVISOR_PIN) {
                closePinModal();
                currentReportType = "pengawas";
                showPage('laporanPengawas');
            } else {
                document.getElementById('pinError').style.display = 'block';
                // Reset PIN inputs
                document.getElementById('pin1').value = '';
                document.getElementById('pin2').value = '';
                document.getElementById('pin3').value = '';
                document.getElementById('pin4').value = '';
                document.getElementById('pin1').focus();
            }
        }

        // Show notification
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            const notificationText = document.getElementById('notificationText');
            
            if (type === 'success') {
                notification.style.backgroundColor = 'var(--success-green)';
            } else if (type === 'error') {
                notification.style.backgroundColor = 'var(--danger-red)';
            } else if (type === 'warning') {
                notification.style.backgroundColor = 'var(--warning-yellow)';
            }
            
            notificationText.textContent = message;
            notification.style.display = 'block';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000);
        }

        // Helper: Convert File to Base64
        function fileToBase64(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = () => resolve(reader.result);
                reader.onerror = error => reject(error);
            });
        }

        // Helper: Format Date
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('id-ID', {
                day: '2-digit',
                month: 'long',
                year: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        }

        // Helper: Get Full Date with Day Name
        function getFullDateWithDay(dateString) {
            const date = new Date(dateString);
            const days = ['Minggu', 'Senin', 'Selasa', 'Rabu', 'Kamis', 'Jumat', 'Sabtu'];
            const dayName = days[date.getDay()];
            const formattedDate = date.toLocaleDateString('id-ID', {
                day: '2-digit',
                month: 'long',
                year: 'numeric'
            });
            return `${dayName}, ${formattedDate}`;
        }

        // Helper: Create image from preview modal content
        async function createReportImageFromPreview(reportData) {
            // Create a canvas element with larger dimensions for better quality
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            
            // Set canvas size - LARGER for better visibility
            const canvasWidth = 900;
            const canvasHeight = 1400; // Reduced height since we removed the activity section
            
            canvas.width = canvasWidth;
            canvas.height = canvasHeight;
            
            // Background
            ctx.fillStyle = '#ffffff';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Header with gradient - TEBAL
            const gradient = ctx.createLinearGradient(0, 0, canvas.width, 0);
            gradient.addColorStop(0, '#DC143C');
            gradient.addColorStop(1, '#8B0000');
            
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, canvas.width, 90);
            
            // Title - LEBAR
            ctx.fillStyle = '#ffffff';
            ctx.font = 'bold 38px Arial';
            ctx.textAlign = 'center';
            ctx.fillText(reportData.reportType === 'karyawan' ? 'LAPORAN KARYAWAN' : 'LAPORAN PENGAWAS', canvas.width / 2, 60);
            
            // Logo section - LEBAR
            ctx.fillStyle = '#f8f9fa';
            ctx.fillRect(0, 90, canvas.width, 70);
            
            // Logo placeholder - LEBAR
            ctx.fillStyle = '#DC143C';
            ctx.font = 'bold 26px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('RSUD Talaud 2026', canvas.width / 2, 140);
            
            // Content sections - SPASI LEBAR
            let yPos = 180;
            const sectionHeight = 45;
            
            // Report type specific content
            if (reportData.reportType === 'karyawan') {
                // Karyawan form fields - PERBAIKAN TATA LETAK
                // Section: Identitas Karyawan
                ctx.fillStyle = '#f8f9fa';
                ctx.fillRect(0, yPos, canvas.width, sectionHeight);
                ctx.fillStyle = '#DC143C';
                ctx.font = 'bold 34px Arial';
                ctx.textAlign = 'left';
                ctx.fillText('IDENTITAS KARYAWAN', 30, yPos + 38);
                
                yPos += sectionHeight + 25;
                
                // Form fields - TATA LETAK YANG LEBAR TERSTRUKTUR
                // Nama Karyawan
                ctx.fillStyle = '#2c3e50';
                ctx.font = 'bold 30px Arial';
                ctx.fillText('Nama Karyawan:', 30, yPos + 38);
                ctx.font = '30px Arial';
                ctx.fillText(reportData.namaKaryawan, 30, yPos + 80);
                yPos += 100;
                
                // Jenis Karyawan
                ctx.fillStyle = '#2c3e50';
                ctx.font = 'bold 30px Arial';
                ctx.fillText('Jenis Karyawan:', 30, yPos + 38);
                ctx.font = '30px Arial';
                ctx.fillText(reportData.jenisKaryawan, 30, yPos + 80);
                yPos += 100;
                
                // Area Kerja
                ctx.fillStyle = '#2c3e50';
                ctx.font = 'bold 30px Arial';
                ctx.fillText('Area Kerja:', 30, yPos + 38);
                ctx.font = '30px Arial';
                ctx.fillText(reportData.areaKerja, 30, yPos + 80);
                yPos += 100;
                
                // Shift Kerja
                ctx.fillStyle = '#2c3e50';
                ctx.font = 'bold 30px Arial';
                ctx.fillText('Shift Kerja:', 30, yPos + 38);
                ctx.font = '30px Arial';
                ctx.fillText(reportData.shiftKerja, 30, yPos + 80);
                yPos += 120;
            } else {
                // Supervisor form fields - TATA LETAK YANG DIPERBAIKI
                // Section: Identitas Pengawas
                ctx.fillStyle = '#f8f9fa';
                ctx.fillRect(0, yPos, canvas.width, sectionHeight);
                ctx.fillStyle = '#DC143C';
                ctx.font = 'bold 34px Arial';
                ctx.textAlign = 'left';
                ctx.fillText('IDENTITAS PENGAWAS', 30, yPos + 38);
                
                yPos += sectionHeight + 25;
                
                // Form fields - TATA LETAK YANG LEBAR TERSTRUKTUR
                // Nama Pengawas
                ctx.fillStyle = '#2c3e50';
                ctx.font = 'bold 30px Arial';
                ctx.fillText('Nama Pengawas:', 30, yPos + 38);
                ctx.font = '30px Arial';
                ctx.fillText(reportData.namaPengawas, 30, yPos + 80);
                yPos += 100;
                
                // Tanggal Pengawasan
                ctx.fillStyle = '#2c3e50';
                ctx.font = 'bold 30px Arial';
                ctx.fillText('Tanggal Pengawasan:', 30, yPos + 38);
                ctx.font = '30px Arial';
                ctx.fillText(reportData.tanggalPengawasan, 30, yPos + 80);
                yPos += 100;
                
                // Area Pengawasan
                ctx.fillStyle = '#2c3e50';
                ctx.font = 'bold 30px Arial';
                ctx.fillText('Area Pengawasan:', 30, yPos + 38);
                ctx.font = '30px Arial';
                ctx.fillText(reportData.areaPengawasan, 30, yPos + 80);
                yPos += 100;
                
                // Shift Pengawasan
                ctx.fillStyle = '#2c3e50';
                ctx.font = 'bold 30px Arial';
                ctx.fillText('Shift Pengawasan:', 30, yPos + 38);
                ctx.font = '30px Arial';
                ctx.fillText(reportData.shiftPengawasan, 30, yPos + 80);
                yPos += 120;
                
                // Section: Informasi Karyawan
                ctx.fillStyle = '#f8f9fa';
                ctx.fillRect(0, yPos, canvas.width, sectionHeight);
                ctx.fillStyle = '#DC143C';
                ctx.font = 'bold 34px Arial';
                ctx.textAlign = 'left';
                ctx.fillText('INFORMASI KARYAWAN', 30, yPos + 38);
                
                yPos += sectionHeight + 25;
                
                // Nama Karyawan yang Diawasi
                ctx.fillStyle = '#2c3e50';
                ctx.font = 'bold 30px Arial';
                ctx.fillText('Nama Karyawan:', 30, yPos + 38);
                ctx.font = '30px Arial';
                ctx.fillText(reportData.karyawanDiawasi, 30, yPos + 80);
                yPos += 120;
                
                // Section: Hasil Pengawasan
                ctx.fillStyle = '#f8f9fa';
                ctx.fillRect(0, yPos, canvas.width, sectionHeight);
                ctx.fillStyle = '#DC143C';
                ctx.font = 'bold 34px Arial';
                ctx.textAlign = 'left';
                ctx.fillText('HASIL PENGAWASAN', 30, yPos + 38);
                
                yPos += sectionHeight + 25;
                
                // Draw supervision text box - LEBAR
                ctx.fillStyle = '#ffffff';
                ctx.fillRect(30, yPos, canvas.width - 60, 240);
                
                ctx.strokeStyle = '#DC143C';
                ctx.lineWidth = 3;
                ctx.strokeRect(30, yPos, canvas.width - 60, 240);
                
                // Draw supervision text - LEBAR dengan baris yang lebih lebar
                ctx.fillStyle = '#2c3e50';
                ctx.font = '26px Arial';
                const words = reportData.hasilPengawasan.split(' ');
                let line = '';
                let lineCount = 0;
                const maxLines = 8;
                
                for (let i = 0; i < words.length && lineCount < maxLines; i++) {
                    const testLine = line + words[i] + ' ';
                    const metrics = ctx.measureText(testLine);
                    const testWidth = metrics.width;
                    
                    if (testWidth > canvas.width - 100 && line.length > 0) {
                        ctx.fillText(line, 40, yPos + 45 + (lineCount * 40));
                        line = words[i] + ' ';
                        lineCount++;
                    } else {
                        line = testLine;
                    }
                }
                
                if (line.length > 0 && lineCount < maxLines) {
                    ctx.fillText(line, 40, yPos + 45 + (lineCount * 40));
                }
                
                yPos += 260;
                
                // Add catatan evaluasi if exists
                if (reportData.catatanEvaluasi) {
                    // Section: Catatan Evaluasi
                    ctx.fillStyle = '#f8f9fa';
                    ctx.fillRect(0, yPos, canvas.width, sectionHeight);
                    ctx.fillStyle = '#DC143C';
                    ctx.font = 'bold 34px Arial';
                    ctx.textAlign = 'left';
                    ctx.fillText('CATATAN EVALUASI', 30, yPos + 38);
                    
                    yPos += sectionHeight + 25;
                    
                    // Draw evaluation text box - LEBAR
                    ctx.fillStyle = '#ffffff';
                    ctx.fillRect(30, yPos, canvas.width - 60, 190);
                    
                    ctx.strokeStyle = '#DC143C';
                    ctx.lineWidth = 3;
                    ctx.strokeRect(30, yPos, canvas.width - 60, 190);
                    
                    // Draw evaluation text - LEBAR dengan baris yang lebih lebar
                    ctx.fillStyle = '#2c3e50';
                    ctx.font = '26px Arial';
                    const evalWords = reportData.catatanEvaluasi.split(' ');
                    let evalLine = '';
                    let evalLineCount = 0;
                    const evalMaxLines = 7;
                    
                    for (let i = 0; i < evalWords.length && evalLineCount < evalMaxLines; i++) {
                        const testLine = evalLine + evalWords[i] + ' ';
                        const metrics = ctx.measureText(testLine);
                        const testWidth = metrics.width;
                        
                        if (testWidth > canvas.width - 100 && evalLine.length > 0) {
                            ctx.fillText(evalLine, 40, yPos + 45 + (evalLineCount * 40));
                            evalLine = evalWords[i] + ' ';
                            evalLineCount++;
                        } else {
                            evalLine = testLine;
                        }
                    }
                    
                    if (evalLine.length > 0 && evalLineCount < evalMaxLines) {
                        ctx.fillText(evalLine, 40, yPos + 45 + (evalLineCount * 40));
                    }
                    
                    yPos += 210;
                }
            }
            
            // Add photo if exists - PERBESARAN FOTO DAN FOOTER DI BAWAH
            if (reportData.foto) {
                // Section: Dokumentasi
                ctx.fillStyle = '#f8f9fa';
                ctx.fillRect(0, yPos, canvas.width, sectionHeight);
                ctx.fillStyle = '#DC143C';
                ctx.font = 'bold 34px Arial';
                ctx.textAlign = 'left';
                ctx.fillText('DOKUMENTASI', 30, yPos + 38);
                
                yPos += sectionHeight + 25;
                
                // Draw photo frame - LEBAR DAN TINGGI
                ctx.fillStyle = '#ffffff';
                const photoWidth = canvas.width - 60;
                const photoHeight = 700;
                ctx.fillRect(30, yPos, photoWidth, photoHeight);
                
                ctx.strokeStyle = '#DC143C';
                ctx.lineWidth = 4;
                ctx.strokeRect(30, yPos, photoWidth, photoHeight);
                
                // Load and draw photo - PERBESARAN
                const img = new Image();
                img.src = reportData.foto;
                
                // Calculate aspect ratio to fit in frame
                const imgAspectRatio = img.width / img.height;
                const frameAspectRatio = photoWidth / photoHeight;
                
                let drawWidth, drawHeight, drawX, drawY;
                
                if (imgAspectRatio > frameAspectRatio) {
                    // Image is wider than frame
                    drawWidth = photoWidth;
                    drawHeight = drawWidth / imgAspectRatio;
                    drawX = 30;
                    drawY = yPos + (photoHeight - drawHeight) / 2;
                } else {
                    // Image is taller than frame
                    drawHeight = photoHeight;
                    drawWidth = drawHeight * imgAspectRatio;
                    drawX = 30 + (photoWidth - drawWidth) / 2;
                    drawY = yPos;
                }
                
                ctx.drawImage(img, drawX, drawY, drawWidth, drawHeight);
                
                // Add watermark to photo - LEBAR
                ctx.fillStyle = 'rgba(220, 20, 60, 0.7)';
                const watermarkText = 'RSUD Talaud 2026';
                ctx.font = 'bold 30px Arial';
                const textWidth = ctx.measureText(watermarkText).width;
                ctx.fillRect(canvas.width - textWidth - 70, yPos + photoHeight - 60, textWidth + 60, 60);
                
                ctx.fillStyle = '#ffffff';
                ctx.fillText(watermarkText, canvas.width - textWidth - 65, yPos + photoHeight - 25);
            }
            
            // Footer - TEBAL DAN DI BAWAH DENGAN TANGGAL LENGKAP (TANPA WAKTU)
            const footerGradient = ctx.createLinearGradient(0, canvas.height - 70, 0, canvas.height);
            footerGradient.addColorStop(0, '#DC143C');
            footerGradient.addColorStop(1, '#8B0000');
            
            ctx.fillStyle = footerGradient;
            ctx.fillRect(0, canvas.height - 70, canvas.width, 70);
            
            ctx.fillStyle = '#ffffff';
            ctx.font = 'bold 28px Arial';
            ctx.textAlign = 'center';
            
            // Get current date with day name (without time)
            const currentDate = new Date(reportData.tanggal);
            const days = ['Minggu', 'Senin', 'Selasa', 'Rabu', 'Kamis', 'Jumat', 'Sabtu'];
            const dayName = days[currentDate.getDay()];
            const formattedDate = currentDate.toLocaleDateString('id-ID', {
                day: '2-digit',
                month: 'long',
                year: 'numeric'
            });
            
            // Footer text with full date (without time)
            ctx.fillText('RSUD Talaud 2026', canvas.width / 2, canvas.height - 40);
            ctx.fillText(`${dayName}, ${formattedDate}`, canvas.width / 2, canvas.height - 10);
            
            // Convert canvas to blob with higher quality
            return new Promise((resolve) => {
                canvas.toBlob((blob) => {
                    resolve(blob);
                }, 'image/jpeg', 0.95);
            });
        }

        // Helper: Create separate activity image
        async function createActivityImage(reportData) {
            // Create a canvas element to draw the activity photo
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            
            // Create a watermark
            const watermarkText = 'RSUD Talaud 2026';
            
            // Load the image
            const img = new Image();
            img.src = reportData.foto;
            
            await new Promise((resolve) => {
                img.onload = resolve;
            });
            
            // Set canvas size to match photo aspect ratio
            const maxWidth = 2200;
            const maxHeight = 2200;
            
            let width = img.width;
            let height = img.height;
            
            if (width > maxWidth) {
                height = height * (maxWidth / width);
                width = maxWidth;
            }
            
            if (height > maxHeight) {
                width = width * (maxHeight / height);
                height = maxHeight;
            }
            
            canvas.width = width;
            canvas.height = height;
            
            // Draw the image
            ctx.drawImage(img, 0, 0, width, height);
            
            // Add watermark
            ctx.font = 'bold 36px Arial';
            const textWidth = ctx.measureText(watermarkText).width;
            
            // Create semi-transparent background for watermark
            ctx.fillStyle = 'rgba(220, 20, 60, 0.7)';
            ctx.fillRect(width - textWidth - 70, height - 70, textWidth + 70, 70);
            
            // Draw watermark text
            ctx.fillStyle = '#ffffff';
            ctx.fillText(watermarkText, width - textWidth - 65, height - 30);
            
            // Convert canvas to blob with higher quality
            return new Promise((resolve) => {
                canvas.toBlob((blob) => {
                    resolve(blob);
                }, 'image/jpeg', 0.95);
            });
        }

        // Format report for Telegram (simplified since the image contains all details)
        function formatReportForTelegram(reportData) {
            const timestamp = formatDate(reportData.tanggal);
            let message = `<b>Laporan ${reportData.reportType === 'karyawan' ? 'Karyawan' : 'Pengawas'} - ${timestamp}</b>\n\n`;
            
            if (reportData.reportType === 'karyawan') {
                message += `<b>Nama:</b> ${reportData.namaKaryawan}\n`;
                message += `<b>Jenis:</b> ${reportData.jenisKaryawan}\n`;
                message += `<b>Area:</b> ${reportData.areaKerja}\n`;
                message += `<b>Shift:</b> ${reportData.shiftKerja}\n`;
            } else {
                message += `<b>Pengawas:</b> ${reportData.namaPengawas}\n`;
                message += `<b>Tanggal:</b> ${reportData.tanggalPengawasan}\n`;
                message += `<b>Area:</b> ${reportData.areaPengawasan}\n`;
                message += `<b>Shift:</b> ${reportData.shiftPengawasan}\n`;
                message += `<b>Karyawan:</b> ${reportData.karyawanDiawasi}\n`;
            }
            
            message += `\n<b>Detail lengkap ada di gambar laporan.</b>`;
            
            return message;
        }

        // Send message to Telegram with configuration
        async function sendToTelegram(message, photo = null, config) {
            try {
                let formData = new FormData();
                formData.append('chat_id', config.chatId);
                formData.append('text', message);
                
                // If there's a photo, send as photo
                if (photo) {
                    formData.delete('text'); // Remove text when sending photo
                    formData.append('photo', photo);
                    formData.append('caption', message);
                    formData.append('parse_mode', 'HTML');
                }
                
                const response = await fetch(`${config.apiUrl}/send${photo ? 'Photo' : 'Message'}`, {
                    method: 'POST',
                    body: formData
                });
                
                const result = await response.json();
                
                if (result.ok) {
                    return { success: true, result };
                } else {
                    return { success: false, error: result.description };
                }
            } catch (error) {
                return { success: false, error: error.message };
            }
        }

        // Save report to localStorage
        function saveReportToStorage(reportData) {
            // Get existing reports from localStorage
            let reports = JSON.parse(localStorage.getItem('reports')) || [];
            
            // Add new report to the beginning of the array
            reports.unshift(reportData);
            
            // Save updated reports to localStorage
            localStorage.setItem('reports', JSON.stringify(reports));
            
            // Limit to 50 most recent reports to prevent storage issues
            if (reports.length > 50) {
                reports = reports.slice(0, 50);
                localStorage.setItem('reports', JSON.stringify(reports));
            }
        }

        // Load reports from localStorage
        function loadHistory() {
            const historyContainer = document.getElementById('historyContainer');
            const emptyState = document.getElementById('emptyState');
            
            // Get reports from localStorage
            const reports = JSON.parse(localStorage.getItem('reports')) || [];
            
            // Clear existing history
            historyContainer.innerHTML = '';
            
            if (reports.length === 0) {
                // Show empty state if no reports
                emptyState.style.display = 'block';
                historyContainer.style.display = 'none';
            } else {
                // Hide empty state and show history
                emptyState.style.display = 'none';
                historyContainer.style.display = 'block';
                
                // Add each report to the history container
                reports.forEach(report => {
                    const historyItem = document.createElement('div');
                    historyItem.className = 'history-item';
                    
                    // Format date
                    const reportDate = new Date(report.tanggal);
                    const formattedDate = formatDate(report.tanggal);
                    
                    // Create history item HTML based on report type
                    if (report.reportType === 'karyawan') {
                        historyItem.innerHTML = `
                            <div class="history-header">
                                <div class="history-title">Laporan Karyawan</div>
                                <div class="history-date">${formattedDate}</div>
                            </div>
                            <div class="history-content">
                                <div class="history-field">
                                    <span class="history-label">Nama Karyawan:</span>
                                    <span class="history-value">${report.namaKaryawan}</span>
                                </div>
                                <div class="history-field">
                                    <span class="history-label">Jenis Karyawan:</span>
                                    <span class="history-value">${report.jenisKaryawan}</span>
                                </div>
                                <div class="history-field">
                                    <span class="history-label">Area Kerja:</span>
                                    <span class="history-value">${report.areaKerja}</span>
                                </div>
                                <div class="history-field">
                                    <span class="history-label">Shift:</span>
                                    <span class="history-value">${report.shiftKerja}</span>
                                </div>
                            </div>
                            <div class="history-footer">
                                <div class="history-status">Tersimpan</div>
                                <div class="history-actions">
                                    ${report.foto ? `<button class="history-action-btn" onclick="viewImage('${report.foto}')"><i class="bi bi-image"></i></button>` : ''}
                                </div>
                            </div>
                        `;
                    } else {
                        historyItem.innerHTML = `
                            <div class="history-header">
                                <div class="history-title">Laporan Pengawas</div>
                                <div class="history-date">${formattedDate}</div>
                            </div>
                            <div class="history-content">
                                <div class="history-field">
                                    <span class="history-label">Nama Pengawas:</span>
                                    <span class="history-value">${report.namaPengawas}</span>
                                </div>
                                <div class="history-field">
                                    <span class="history-label">Tanggal Pengawasan:</span>
                                    <span class="history-value">${report.tanggalPengawasan}</span>
                                </div>
                                <div class="history-field">
                                    <span class="history-label">Area Pengawasan:</span>
                                    <span class="history-value">${report.areaPengawasan}</span>
                                </div>
                                <div class="history-field">
                                    <span class="history-label">Shift:</span>
                                    <span class="history-value">${report.shiftPengawasan}</span>
                                </div>
                                <div class="history-field">
                                    <span class="history-label">Karyawan Diawasi:</span>
                                    <span class="history-value">${report.karyawanDiawasi}</span>
                                </div>
                                <div class="history-field">
                                    <span class="history-label">Hasil Pengawasan:</span>
                                    <span class="history-value">${report.hasilPengawasan}</span>
                                </div>
                                ${report.catatanEvaluasi ? `
                                <div class="history-field">
                                    <span class="history-label">Catatan Evaluasi:</span>
                                    <span class="history-value">${report.catatanEvaluasi}</span>
                                </div>
                                ` : ''}
                            </div>
                            <div class="history-footer">
                                <div class="history-status">Tersimpan</div>
                                <div class="history-actions">
                                    ${report.foto ? `<button class="history-action-btn" onclick="viewImage('${report.foto}')"><i class="bi bi-image"></i></button>` : ''}
                                </div>
                            </div>
                        `;
                    }
                    
                    historyContainer.appendChild(historyItem);
                });
            }
        }

        // View image in modal
        function viewImage(imageSrc) {
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.display = 'block';
            
            const modalContent = document.createElement('div');
            modalContent.className = 'modal-content';
            modalContent.style.maxWidth = '90%';
            modalContent.style.margin = '5% auto';
            
            const modalHeader = document.createElement('div');
            modalHeader.className = 'modal-header';
            
            const modalTitle = document.createElement('h3');
            modalTitle.className = 'modal-title';
            modalTitle.textContent = 'Foto Laporan';
            
            const closeBtn = document.createElement('span');
            closeBtn.className = 'close';
            closeBtn.innerHTML = '&times;';
            closeBtn.onclick = function() {
                document.body.removeChild(modal);
            };
            
            modalHeader.appendChild(modalTitle);
            modalHeader.appendChild(closeBtn);
            
            const modalBody = document.createElement('div');
            modalBody.className = 'modal-body';
            modalBody.style.textAlign = 'center';
            
            const img = document.createElement('img');
            img.src = imageSrc;
            img.style.maxWidth = '100%';
            img.style.maxHeight = '70vh';
            img.style.borderRadius = '8px';
            
            modalBody.appendChild(img);
            
            modalContent.appendChild(modalHeader);
            modalContent.appendChild(modalBody);
            modal.appendChild(modalContent);
            
            document.body.appendChild(modal);
        }

        // Handle form submit laporan karyawan
        document.getElementById('formLaporanKaryawan').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const fotoInput = document.getElementById('fotoLaporan');
            let fotoBase64 = null;
            
            // Read photo if exists
            if (fotoInput.files && fotoInput.files[0]) {
                try {
                    showNotification('Memproses foto...', 'warning');
                    fotoBase64 = await fileToBase64(fotoInput.files[0]);
                } catch (err) {
                    showNotification('Gagal memproses foto', 'error');
                    return;
                }
            }
            
            const formData = {
                id: Date.now(),
                namaKaryawan: document.getElementById('namaKaryawan').value.toUpperCase(),
                jenisKaryawan: document.getElementById('jenisKaryawan').value,
                areaKerja: document.getElementById('areaKerja').value,
                shiftKerja: document.getElementById('shiftKerja').value,
                tanggal: new Date().toISOString(),
                foto: fotoBase64,
                reportType: 'karyawan'
            };
            
            // Store current report data globally
            currentReportData = formData;
            
            // Show confirmation modal
            showConfirmationModal(formData);
        });

        // Handle form submit laporan pengawas
        document.getElementById('formLaporanPengawas').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const fotoInput = document.getElementById('fotoPengawasan');
            let fotoBase64 = null;
            
            // Read photo if exists
            if (fotoInput.files && fotoInput.files[0]) {
                try {
                    showNotification('Memproses foto...', 'warning');
                    fotoBase64 = await fileToBase64(fotoInput.files[0]);
                } catch (err) {
                    showNotification('Gagal memproses foto', 'error');
                    return;
                }
            }
            
            const formData = {
                id: Date.now(),
                namaPengawas: document.getElementById('namaPengawas').value.toUpperCase(),
                tanggalPengawasan: document.getElementById('tanggalPengawasan').value,
                areaPengawasan: document.getElementById('areaPengawasan').value,
                shiftPengawasan: document.getElementById('shiftPengawasan').value,
                karyawanDiawasi: document.getElementById('karyawanDiawasi').value.toUpperCase(),
                hasilPengawasan: document.getElementById('hasilPengawasan').value.toUpperCase(),
                catatanEvaluasi: document.getElementById('catatanEvaluasi').value.toUpperCase(),
                tanggal: new Date().toISOString(),
                foto: fotoBase64,
                reportType: 'pengawas'
            };
            
            // Store current report data globally
            currentReportData = formData;
            
            // Show confirmation modal
            showConfirmationModal(formData);
        });

        // Show confirmation modal
        function showConfirmationModal(formData) {
            const modal = document.getElementById('confirmationModal');
            const preview = document.getElementById('reportPreview');
            
            const formattedTanggal = formatDate(formData.tanggal);
            
            let previewHTML = `
                <div class="report-preview-header">
                    <div class="report-preview-title">${formData.reportType === 'karyawan' ? 'Laporan Karyawan' : 'Laporan Pengawas'}</div>
                    <div class="report-preview-date">
                        <i class="bi bi-clock"></i> ${formattedTanggal}
                    </div>
                </div>
            `;
            
            if (formData.reportType === 'karyawan') {
                previewHTML += `
                    <div class="report-preview-meta">
                        <span class="report-preview-tag">${formData.jenisKaryawan}</span>
                        <span class="report-preview-tag">${formData.shiftKerja}</span>
                    </div>
                    <div class="report-preview-item">
                        <div class="report-preview-label">Nama Karyawan:</div>
                        <div class="report-preview-value">${formData.namaKaryawan}</div>
                    </div>
                    <div class="report-preview-item">
                        <div class="report-preview-label">Area Kerja:</div>
                        <div class="report-preview-value">${formData.areaKerja}</div>
                    </div>
                `;
            } else {
                previewHTML += `
                    <div class="report-preview-meta">
                        <span class="report-preview-tag">${formData.shiftPengawasan}</span>
                    </div>
                    <div class="report-preview-item">
                        <div class="report-preview-label">Nama Pengawas:</div>
                        <div class="report-preview-value">${formData.namaPengawas}</div>
                    </div>
                    <div class="report-preview-item">
                        <div class="report-preview-label">Tanggal Pengawasan:</div>
                        <div class="report-preview-value">${formData.tanggalPengawasan}</div>
                    </div>
                    <div class="report-preview-item">
                        <div class="report-preview-label">Area Pengawasan:</div>
                        <div class="report-preview-value">${formData.areaPengawasan}</div>
                    </div>
                    <div class="report-preview-item">
                        <div class="report-preview-label">Karyawan yang Diawasi:</div>
                        <div class="report-preview-value">${formData.karyawanDiawasi}</div>
                    </div>
                    <div class="report-preview-item">
                        <div class="report-preview-label">Hasil Pengawasan:</div>
                        <div class="report-preview-value">${formData.hasilPengawasan}</div>
                    </div>
                    ${formData.catatanEvaluasi ? `
                    <div class="report-preview-item">
                        <div class="report-preview-label">Catatan Evaluasi:</div>
                        <div class="report-preview-value">${formData.catatanEvaluasi}</div>
                    </div>
                    ` : ''}
                `;
            }
            
            if (formData.foto) {
                previewHTML += `
                    <div class="preview-image-container">
                        <img src="${formData.foto}" alt="Foto Preview" class="preview-image">
                    </div>
                `;
            }
            
            preview.innerHTML = previewHTML;
            modal.style.display = 'block';
        }

        function closeModal() {
            document.getElementById('confirmationModal').style.display = 'none';
        }

        // Confirm and Save
        async function confirmSave() {
            // Use the globally stored report data instead of trying to get it from DOM
            if (!currentReportData) {
                showNotification('Data laporan tidak tersedia', 'error');
                return;
            }
            
            const formData = currentReportData;
            closeModal();
            
            try {
                // Show loading notification
                showNotification('Mempersiapkan laporan...', 'warning');
                
                // Create report image using the new function that matches the preview
                const reportImageBlob = await createReportImageFromPreview(formData);
                
                // Create separate activity image if photo exists
                let activityImageBlob = null;
                if (formData.foto) {
                    showNotification('Mempersiapkan foto kegiatan...', 'warning');
                    activityImageBlob = await createActivityImage(formData);
                }
                
                // Format message for Telegram
                const telegramMessage = formatReportForTelegram(formData);
                
                // Determine configuration based on report type
                const config = formData.reportType === 'pengawas' ? {
                    chatId: TELEGRAM_CHAT_ID_SUPERVISOR,
                    apiUrl: TELEGRAM_API_URL_SUPERVISOR
                } : {
                    chatId: TELEGRAM_CHAT_ID_EMPLOYEE,
                    apiUrl: TELEGRAM_API_URL_EMPLOYEE
                };
                
                // Send report image to server
                showNotification('Mengirim laporan...', 'warning');
                
                const reportResponse = await sendToTelegram(telegramMessage, reportImageBlob, config);
                
                if (reportResponse.success && activityImageBlob) {
                    // If report sent successfully and there's an activity image, send it separately
                    showNotification('Mengirim foto kegiatan...', 'warning');
                    
                    const activityCaption = 'Foto Kegiatan - ' + (formData.reportType === 'karyawan' ? formData.namaKaryawan : formData.namaPengawas);
                    const activityResponse = await sendToTelegram(activityCaption, activityImageBlob, config);
                    
                    if (activityResponse.success) {
                        // Save to localStorage
                        saveReportToStorage(formData);
                        
                        // Show success notification
                        showNotification('Laporan berhasil dikirim!', 'success');
                        
                        // Reset form
                        if (formData.reportType === 'karyawan') {
                            document.getElementById('formLaporanKaryawan').reset();
                        } else {
                            document.getElementById('formLaporanPengawas').reset();
                        }
                        
                        // Clear the global report data
                        currentReportData = null;
                        
                        // Go back to home page after delay
                        setTimeout(() => showPage('beranda'), 1500);
                    } else {
                        showNotification(`Laporan berhasil dikirim, tetapi gagal mengirim foto terpisah: ${activityResponse.error}`, 'warning');
                        
                        // Save to localStorage even if photo failed to send separately
                        saveReportToStorage(formData);
                        
                        // Reset form
                        if (formData.reportType === 'karyawan') {
                            document.getElementById('formLaporanKaryawan').reset();
                        } else {
                            document.getElementById('formLaporanPengawas').reset();
                        }
                        
                        // Clear the global report data
                        currentReportData = null;
                        
                        // Go back to home page after delay
                        setTimeout(() => showPage('beranda'), 1500);
                    }
                } else if (reportResponse.success) {
                    // If report sent successfully but no photo to send separately
                    // Save to localStorage
                    saveReportToStorage(formData);
                    
                    // Show success notification
                    showNotification('Laporan berhasil dikirim!', 'success');
                    
                    // Reset form
                    if (formData.reportType === 'karyawan') {
                        document.getElementById('formLaporanKaryawan').reset();
                    } else {
                        document.getElementById('formLaporanPengawas').reset();
                    }
                    
                    // Clear the global report data
                    currentReportData = null;
                    
                    // Go back to home page after delay
                    setTimeout(() => showPage('beranda'), 1500);
                } else {
                    // Handle error
                    showNotification(`Gagal mengirim laporan: ${reportResponse.error}`, 'error');
                }
            } catch (error) {
                console.error('Error sending report:', error);
                showNotification(`Gagal mengirim laporan: ${error.message}`, 'error');
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            // Set today's date as default for supervisor report
            const today = new Date().toISOString().split('T')[0];
            const dateInput = document.getElementById('tanggalPengawasan');
            if (dateInput) {
                dateInput.value = today;
                dateInput.max = today; // Prevent selecting future dates
            }
        });

        // Prevent zoom
        let lastTouchEnd = 0;
        document.addEventListener('touchend', (e) => {
            const now = Date.now();
            if (now - lastTouchEnd <= 300) e.preventDefault();
            lastTouchEnd = now;
        }, false);
    </script>
</body>
</html>
